# Vivian Windows Test Project

This repository contains a complete Unity project with the necessary modules for building a Vivian based application for Microsoft Windows or other computer systems.

The necessary modules for running this project are contained within [Git Submodules](https://git-scm.com/book/en/v2/Git-Tools-Submodules). In order to get the project running, you will need to initialize the submodules (i.e. clone them within the project) as they are not cloned automatically upon cloning the main project.

## Initialize the Project

1. Clone the project and initialize the submodules.
+ In a GUI client, this can be proposed to you when cloning the project.
+ If you use Git through the CLI, run this command to have the submodules directly checked out:
`git clone --recurse-submodules https://gitlab.com/usability-engineering-ar-mr-vr/vivian-framework/vivian-windows-test-project.git`

2. Download the matching version of Unity used for this project. This can be done through the Unity Hub.
+ Make sure to install the **build support** modules required for your platform of interest.

3. Add the cloned project into Unity Hub. Just navigate to the root folder and click **Select Folder**.

4. In Unity, go to *File > Build Settings...*, select your platform of interest, if not already done, and click **Switch Platform**.

5. The project comes with different example prototypes. You can open them in individual scenes provided within the project.
+ Some scenes may appear empty before running. The reason is that the prototypes are usually loaded at runtime.

6. For understanding how prototypes are made, built, and used in the scenes, see the [Vivian Framework](#vivian-framework) section.

## Vivian Framework

### What does a prototype look like?
A Vivian prototype is a 3D model accompanied with configuration files. Vivian reads the configuration files to make the static 3D model interactive.

To allow Vivian to interpret the model file and the configuration files correctly, the files need to adhere to a certain folder structure on the disk. This structure looks like the following:

+ *Prototype folder*: usually named after the prototype
  + *3D Model file*: can be a Unity Prefab (recommended) or a plain 3D model file, such as an FBX or Blender file.
  + *FunctionalSpecification*: contains the configuration files
    + *InteractionElements.json*: defines which elements of the 3D model are interactive such as buttons, touch areas, etc.
    + *VisualizationElements.json*: defines which elements of the 3D model visualize something, such as a light, a screen, or an audio source
    + *VisualizationArrays.json*: allow for combining multiple visualization elements to a single one, used only rarely
    + *States.json*: defines the states in which a prototype can be (e.g., *off*, *waiting*, *heating*) and what the visualization elements are supposed to visualize in a certain state
    + *Transitions.json*: defines under which circumstances (interaction with an interaction element and guards) a prototype changes from one state to another
  + *Screens* (optional, contains images to be displayed on virtual screens of a prototype)
  + *Materials* (optional, contains materials used by the 3D model)

### Relevant objects in a scene

##### VivianFramework
This prefab is loaded at runtime. It contains the **Virtual Prototype** script that takes two parameters: 
+ **Bundle URL**: local or remote URL that points to the prototype. A local URL can point to a folder from the **Vivian Example Prototypes/Resources** package or any other folder in the **Resources** folder of the project. It is also possible to reference an [AssetBundle](#asset-bundles). Valid examples:
  + Microwave
  + AssetBundles/Windows/coffeemachine
+ **Prototype Prefab Name**: name of the prefab created for the prototype model. Prototypes usually contain two declinations of prefabs: one based on a blender source file (`.blend`) and one based on the `.fbx` model file system. Valid examples:
  + microwave
  + coffeemachine2

##### MouseInteraction
This prefab is the platform specific implementation for interacting with a Vivian prototype, in this case using a computer mouse.

### Asset Bundles
Asset Bundles are archives generated by Unity. They may be used in the Vivian Framework to contain the virtual prototypes' models, materials, functional specification, or any resources that are included in their *Example Prototype/Resources* folder (see the **Vivian Example Prototypes** submodule).

The creation of Asset Bundles is only required if you reference an Asset Bundle in the VivianFramework prefab (i.e., from the "Prototype Urls" list or the `index.json` file for remote loading). Prototypes loaded from a remote URL **need** to be in an Asset Bundle format. In case you reference a prototype directly from within the Resources folder in the **Vivian Example Prototypes** package or the **Resources** folder in the project, then the creation is not required.

To generate the Asset Bundles, click *Assets > Build Vivian Prototype Bundles*. This creates an **AssetBundles** folder in the **Assets** folder, if it doesn't already exist. Another folder is created inside, depending on the build target. The AssetBundles are contained there.
